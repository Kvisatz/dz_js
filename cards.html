<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Document</title>
	<link rel="stylesheet" href="css/all.min.css">
	<link rel="stylesheet" href="css/cards.css">
</head>
<body>
	<div class="cards_choice">
		<h1>Выберите карту</h1>
		<div class="chosen_card_wrap">
			<div class="chosen_card"></div>
			<i class="fa fa-sort-desc" aria-hidden="true"></i>
			<ul class="cards_list">
				
			</ul>
		</div>
		
		
		
	</div>
	<div class="cards">
		
	</div>
	
	<script>
		'use strict';

		let cards = [
				{
					cardName: 'Король крестей',
					cardImg: "clubs-884194_960_720.png"
				},
				{
					cardName: 'Валет пик',
					cardImg: "spades-884192_960_720.png"
				},
				{
					cardName: 'Король червей',
					cardImg: "hearts-884196_960_720.webp"
				},
				{
					cardName: 'Дама червей',
					cardImg: "hearts-884201_960_720.webp"

				},		
				{
					cardName: 'Дама пик',
					cardImg: "spades-884203_960_720.png"

				}	
													
					];



		

		function render(){
			let cardsWrap = document.querySelector(".cards");

			let cardsStr = "";
			
			for(let card of cards){
				//console.log(card.cardImg);
				
				cardsStr = cardsStr + `<div class="img_wrap"><img src='images/${card.cardImg}'></div>`;
			}
			cardsWrap.innerHTML = cardsStr;

			step();
		}

		render();
		let shufflerTimeout = interval();
		let shufflerIntervat = setInterval(()=>{
					interval();

				}, 2000);
		console.log(shufflerIntervat);

		function step(){
			let listImages = document.querySelectorAll(".cards .img_wrap");
			
			for(let listImage of listImages){
				listImage.addEventListener('click', (evt)=>{
					
					
					
					clearTimeout(shufflerTimeout);
					console.log(shufflerTimeout);
					evt.target.parentElement.classList.add("active");
					evt.target.classList.add("active");
					//
					//interval();
					clearInterval(shufflerIntervat);
					console.log(shufflerIntervat);
					for(let card of cards){
						//console.log(card);
						if(`images/${card.cardImg}` == evt.target.getAttribute('src')){
							console.log(card.cardName);
							let cardChoice = document.querySelector(".chosen_card");
							if(card.cardName == cardChoice){
								console.log(card.cardName);
							}
						}
					}
					//console.log(evt.target.getAttribute('src'));
					
					//console.log(cardChoice.innerHTML);
					//return evt.target.parentElement;
				})

			}
			//console.log(listImages);
		}
		
		function interval(){
			let cardWrapLast = document.querySelector(".cards .img_wrap:last-child");
			cardWrapLast.classList.add("card_animate");
			let lastEl = cards[cards.length - 1];
			console.log(lastEl);
			cards.pop();
			cards.unshift(lastEl);
			console.log(cardWrapLast.classList);

			
				
				let shufflerTimeout = setTimeout(
				()=>{render()}, 
			1900);
				//clearTimeout(shufflerTimeout);
			console.log(shufflerTimeout);
			return shufflerTimeout;
		}
		



		function init(){
			renderList();
			dropList();
			choice();
		}
		init();

		function renderList(){
			let cardsWrap = document.querySelector(".cards_list");
			let cardsStr = "";
			for(let card of cards){
				console.log(card.cardName);
				cardsStr += `<li>${card.cardName}</li>`; 
			}
			cardsWrap.innerHTML = cardsStr;
		}
		

		function dropList(){
			let chooseList = document.querySelector(".chosen_card_wrap");
			chooseList.addEventListener('click', (evt)=>{
				console.log(evt.target);
				if(evt.target == null){
					console.log("Error");
				}
				else if(evt.target.classList.contains("chosen_card") || evt.target.classList.contains("fa-sort-desc")){
					for(let list of evt.target.parentElement.children){
						console.log(list);
						if(list.classList.contains('cards_list')){
							list.classList.add('active');
						}
					}
					
				}
			})
		}
		

		function choice(){
			let cardsList = document.querySelectorAll(".cards_list li");
			let cardChoice = document.querySelector(".chosen_card");
			console.log(cardsList);
			console.log(cardChoice);
			for(let cardList of cardsList){
				cardList.addEventListener('click', (evt)=>{
					cardChoice.innerHTML = evt.target.innerHTML;
					evt.target.parentElement.classList.remove('active');
					//classList.remove('active');
				});

			}
		} 
		
		// дз 
		// создать массив объектов всех карт где будет храниться название карты и имя картинки с расширением
		// создать выпадающий список с выбором карты из нашего массива
		// карты ротируются обратной стороной
		// в какой то момент времени при клике по карте карта переворачивается и таймер останавливается
		// если карта совпадает с выбранной нами выводим соответствующее сообщение

	</script>
</body>
</html>